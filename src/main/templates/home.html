<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <h2 class="logo">PETAPA</h2>
        </div>
    </nav>

    <div class="container">
        <header>
            <h1>Device Management Dashboard</h1>
            <p class="subtitle">Monitor your IoT devices in real-time</p>
        </header>

        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-icon online-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <div class="stat-number">{{ total_online_devices }}</div>
                    <div class="stat-label">Online</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon offline-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <div class="stat-number">{{ total_offline_devices }}</div>
                    <div class="stat-label">Offline</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon total-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2"/>
                        <path d="M16 3h2a2 2 0 0 1 2 2v2M8 3H6a2 2 0 0 0-2 2v2"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <div class="stat-number">{{ total_IOTDevice }}</div>
                    <div class="stat-label">Total Devices</div>
                </div>
            </div>
        </div>

        <section class="devices-section">
            <div class="section-header">
                <h2>Active Sensors</h2>
                <span class="device-count">{{ SensorDatas|length }} device(s)</span>
            </div>
            
            <div class="devices-grid">
                {% for SensorData in SensorDatas %}
                <div class="device-card">
                    <div class="card-header">
                        <h3>{{ SensorData.device.device_id }}</h3>
                        <span class="status-badge {% if SensorData.device.is_online %}online{% else %}offline{% endif %}">
                            {{ SensorData.device.status }}
                        </span>
                    </div>
                    
                    <div class="sensors-list">
                        <div class="sensor-row">
                            <div class="sensor-info">
                                <div class="sensor-icon-wrapper smoke">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/>
                                    </svg>
                                </div>
                                <span class="sensor-name">Smoke Detector</span>
                            </div>
                            <span class="sensor-value {% if SensorData.is_smoke_detected %}alert{% else %}normal{% endif %}">
                                {% if SensorData.is_smoke_detected %}
                                    DETECTED
                                {% else %}
                                    Normal
                                {% endif %}
                            </span>
                        </div>
                        
                        <div class="sensor-row">
                            <div class="sensor-info">
                                <div class="sensor-icon-wrapper vibration">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M2 8h2"/>
                                        <path d="M2 12h2"/>
                                        <path d="M2 16h2"/>
                                        <path d="M20 8h2"/>
                                        <path d="M20 12h2"/>
                                        <path d="M20 16h2"/>
                                        <rect x="8" y="4" width="8" height="16" rx="1"/>
                                    </svg>
                                </div>
                                <span class="sensor-name">Vibration Detector</span>
                            </div>
                            <span class="sensor-value {% if SensorData.is_vibration_detected %}alert{% else %}normal{% endif %}">
                                {% if SensorData.is_vibration_detected %}
                                    DETECTED
                                {% else %}
                                    Normal
                                {% endif %}
                            </span>
                        </div>
                    </div>
                    
                    <div class="card-footer">
                        <span class="timestamp">Last update: {{ SensorData.timestamp|date:"d/m/Y H:i" }}</span>
                    </div>
                </div>
                {% empty %}
                <div class="empty-state">
                    <div class="empty-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"/>
                            <rect x="14" y="3" width="7" height="7"/>
                            <rect x="14" y="14" width="7" height="7"/>
                            <rect x="3" y="14" width="7" height="7"/>
                        </svg>
                    </div>
                    <h3>No Data Available</h3>
                    <p>There are no sensor readings to display at the moment.</p>
                </div>
                {% endfor %}
            </div>
        </section>
    </div>
</body>
</html>